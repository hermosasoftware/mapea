---
import { Header } from '../../components/layout/Header.tsx';
import { Home } from '../../components/sections/Home.tsx';
import Mission from '../../components/sections/Mission.astro';
import Services from '../../components/sections/Services.astro';
import Clients from '../../components/sections/Clients.astro';
import { Contact } from '../../components/sections/Contact.tsx';
import Footer from '../../components/sections/Footer.astro';
import Layout from '../../layouts/Layout.astro';
import { SEO_DATA } from '../../data/constants';
import { getTranslations } from '../../utils/i18n-astro';

// Generar rutas estáticas para todas las secciones
export async function getStaticPaths() {
  const sections = ['home', 'mission', 'services', 'contact'];
  
  return sections.map(section => ({
    params: { section }
  }));
}

// Idioma fijo para esta página
const currentLang = 'en' as const;

// Obtener la sección de la URL (parámetro dinámico)
const { section } = Astro.params;

// Cargar traducciones para los componentes React
const commonTranslations = await getTranslations(currentLang, 'common');
const homeTranslations = await getTranslations(currentLang, 'home');
const contactTranslations = await getTranslations(currentLang, 'contact');
const navigationTranslations = await getTranslations(currentLang, 'navigation');

// Configuración SEO basada en la sección
const currentSection = section || 'home';
const seoData = SEO_DATA[currentSection as keyof typeof SEO_DATA] || SEO_DATA.home;
---

<Layout 
	title={seoData.title}
	description={seoData.description}
	keywords={seoData.keywords}
	ogImage="/assets/mapea-og-image.jpg"
	section={currentSection}
	lang={currentLang}
>
	<div class="min-h-screen">
		<!-- Critical components - load immediately -->
		<Header 
			translations={commonTranslations} 
			navigationTranslations={navigationTranslations}
			currentLang={currentLang}
			client:load 
		/>
		
		<main>
			<!-- Above the fold - load when visible for better performance -->
			<Home 
				translations={homeTranslations}
				commonTranslations={commonTranslations}
				currentLang={currentLang}
				client:visible 
			/>
			
			<!-- Below the fold - Astro components (no hydration needed) -->
			<Mission lang={currentLang} />
			<Services lang={currentLang} />
			
			<!-- Far below - load when visible -->
			<!-- <Clients lang={currentLang} /> -->
			<Contact 
				translations={contactTranslations}
				commonTranslations={commonTranslations}
				currentLang={currentLang}
				client:visible 
			/>
		</main>
		
		<!-- Static footer - no hydration needed -->
		<Footer lang={currentLang} />
	</div>
</Layout>

